# 🤖 Полная инструкция установки RAG системы для ИИ агента

## 📋 ВАЖНО: Порядок работы с MCP

### ⚠️ Критическое понимание:
- **MCP (Model Context Protocol) настраивается ОДИН РАЗ** для Claude Desktop
- **После настройки MCP НЕ НУЖНО перезапускать Claude** для каждого нового проекта
- **Новый проект = новая сессия = автоматическое обнаружение CLAUDE.md**

### ✅ Правильный алгоритм:
1. **Один раз настроили** MCP в Claude Desktop
2. **Для нового проекта**: создаем CLAUDE.md в корне проекта
3. **Открываем Claude Code** в новом проекте (новая сессия)
4. **Claude автоматически** читает CLAUDE.md и получает доступ к MCP tools
5. **Сразу работает** - никаких перезагрузок!

---

## 🎯 Инструкция для ИИ агента по установке RAG системы

### ФАЗА 1: Первоначальная настройка MCP (выполняется ОДИН РАЗ)

#### Шаг 1: Создание конфигурации Claude Desktop
```bash
# Создать директорию для конфигурации
mkdir -p ~/.config/claude-desktop

# Создать конфигурационный файл
cat > ~/.config/claude-desktop/claude_desktop_config.json << 'EOF'
{
  "mcpServers": {
    "heaterteam-rag": {
      "command": "node",
      "args": ["/Users/aleksejcuprynin/PycharmProjects/chanki/mcp-server/http-mcp-server.js"],
      "env": {
        "NODE_ENV": "production"
      }
    }
  }
}
EOF
```

#### Шаг 2: Проверка системы RAG
```bash
# Проверить что RAG система запущена
curl -s http://localhost:8000/health && echo "✅ RAG Backend работает"
curl -s http://localhost:8200/health && echo "✅ MCP Server работает"

# Если не работает - запустить
cd /Users/aleksejcuprynin/PycharmProjects/chanki && ./start-rag-system.sh
```

#### Шаг 3: Перезапуск Claude Desktop (ТОЛЬКО ПЕРВЫЙ РАЗ)
```bash
# Закрыть Claude Desktop полностью
# Запустить Claude Desktop заново
# MCP подключение произойдет автоматически
```

### ФАЗА 2: Настройка для каждого нового проекта (НЕ ТРЕБУЕТ ПЕРЕЗАГРУЗКИ)

#### Шаг 1: Создание CLAUDE.md в корне проекта
```bash
# Автоматический способ (рекомендуется)
/Users/aleksejcuprynin/PycharmProjects/chanki/setup-new-project.sh /path/to/new/project

# ИЛИ ручной способ
cp /Users/aleksejcuprynin/PycharmProjects/chanki/CLAUDE_MD_TEMPLATE.md /path/to/project/CLAUDE.md
```

#### Шаг 2: Открытие Claude Code в новом проекте
```bash
# Открыть Claude Code в папке проекта
# Claude автоматически найдет CLAUDE.md
# MCP tools будут доступны сразу
```

### ФАЗА 3: Проверка работы

#### Тест автоматического обнаружения MCP tools:
```bash
# В новом проекте Claude должен автоматически иметь доступ к:
# - ask_rag (основной инструмент)
# - get_session_summary
# - add_key_moment
# - list_available_frameworks
# - И другие 8 MCP tools
```

---

## 📋 Полный шаблон CLAUDE.md для проекта

```markdown
# Claude Code - RAG Integration

## 🤖 MCP RAG СИСТЕМА АКТИВНА

**Статус**: RAG Backend работает автоматически через MCP tools

### 🔧 Управление системой:
```bash
# Запуск RAG системы (если не запущена)
cd /Users/aleksejcuprynin/PycharmProjects/chanki && ./start-rag-system.sh

# Проверка статуса
/Users/aleksejcuprynin/PycharmProjects/chanki/check-rag-system.sh
```

### 📊 Доступные ресурсы:
- **6,405 документов** в базе знаний
- **12 MCP tools** автоматически доступны
- **Laravel**: 3,232 документов
- **Filament**: 1,720 документов  
- **Vue.js**: 871 документ
- **React, PHP, JavaScript** и другие

### 🎯 Инструкция для ИИ агента:
1. **Автоматически используй** MCP tools для вопросов по разработке
2. **ask_rag** - основной инструмент для получения знаний
3. **get_session_summary** - для понимания контекста сессии
4. **add_key_moment** - для сохранения важных моментов
5. **НЕ используй** curl команды - все через MCP tools

### 🔍 Примеры использования MCP tools:
- При вопросах по Laravel → автоматически вызывай ask_rag
- При работе с Vue.js → получи актуальную информацию через ask_rag
- При решении проблем → используй знания из 6,405 документов

### ⚡ Ключевые преимущества:
- **Автоматическое обнаружение** MCP tools в новых проектах
- **Нет необходимости** в перезагрузке Claude
- **Универсальность** для любых типов проектов
- **Прозрачная работа** с базой знаний

---
*MCP система настроена глобально. Просто задавай вопросы!*
```

---

## 🎯 Алгоритм для ИИ агента

### При первом запуске системы:
1. **Проверь** наличие конфигурации MCP
2. **Создай** конфигурацию если нужно
3. **Запусти** RAG систему если не запущена
4. **Сообщи** пользователю о необходимости перезапуска Claude Desktop

### При работе с новым проектом:
1. **Создай** CLAUDE.md в корне проекта
2. **Сообщи** пользователю что нужно открыть Claude Code в этой папке
3. **Объясни** что MCP tools будут доступны автоматически
4. **НЕ требуй** перезагрузки Claude Desktop

### При ответах на вопросы:
1. **Автоматически** используй ask_rag для технических вопросов
2. **Сохраняй** важные моменты через add_key_moment
3. **Получай** контекст сессии через get_session_summary
4. **НЕ используй** curl команды

---

## 🚨 Критические моменты для ИИ агента

### ✅ ПРАВИЛЬНО:
- MCP настраивается один раз глобально
- Новый проект = новая сессия = автоматическое обнаружение CLAUDE.md
- MCP tools доступны сразу в новом проекте
- НЕ требуется перезагрузка Claude для каждого проекта

### ❌ НЕПРАВИЛЬНО:
- Требовать перезагрузку Claude для каждого проекта
- Использовать curl команды вместо MCP tools
- Думать что MCP настраивается отдельно для каждого проекта

### 🎯 Итоговая формула:
**Один раз настроил MCP → Для каждого проекта только CLAUDE.md → Открыл Claude Code → Работает автоматически**

---

## 📋 Чек-лист для ИИ агента

### Первоначальная настройка:
- [ ] Создана конфигурация Claude Desktop MCP
- [ ] RAG система запущена и работает
- [ ] Claude Desktop перезапущен (только первый раз)
- [ ] MCP подключение активно

### Для каждого нового проекта:
- [ ] Создан CLAUDE.md в корне проекта
- [ ] Файл содержит инструкции по MCP
- [ ] Пользователь открыл Claude Code в проекте
- [ ] MCP tools автоматически доступны

### Проверка работы:
- [ ] ask_rag отвечает на технические вопросы
- [ ] Нет необходимости в curl командах
- [ ] Контекст сессии сохраняется
- [ ] Система работает прозрачно

---

*Эта инструкция гарантирует правильную работу RAG системы без лишних перезагрузок!*